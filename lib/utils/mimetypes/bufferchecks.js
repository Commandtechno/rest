//special thanks to https://github.com/sindresorhus/file-type/blob/master/index.js (not finished moving it over to here)

const mimetypes = [
	{
		mime: 'image/jpeg',
		ext: 'jpg',
		checks: [{0: 0xFF, 1: 0xD8, 2: 0xFF}]
	},
	{
		mime: 'image/png',
		ext: 'png',
		checks: [{0: 0x89, 1: 0x50, 2: 0x4E, 3: 0x47, 4: 0x0D, 5: 0x0A, 6: 0x1A, 7: 0x0A}]
	},
	{
		mime: 'image/gif',
		ext: 'gif',
		checks: [{0: 0x47, 1: 0x49, 2: 0x46}]
	},
	{
		mime: 'image/webp',
		ext: 'webp',
		checks: [{8: 0x57, 9: 0x45, 10: 0x42, 11: 0x50}]
	},
	{
		mime: 'image/flif',
		ext: 'flif',
		checks: [{0: 0x46, 1: 0x4C, 2: 0x49, 3: 0x46}]
	},
	{
		mime: 'image/x-canon-cr2', //needs to be before `tif` check
		ext: 'cr2',
		checks: [
			{0: 0x49, 1: 0x49, 2: 0x2A, 3: 0x0, 8: 0x43, 9: 0x52},
			{0: 0x4D, 1: 0x4D, 2: 0x0, 3: 0x2A, 8: 0x43, 9: 0x52}
		]
	},
	{
		mime: 'image/tiff',
		ext: 'tif',
		checks: [
			{0: 0x49, 1: 0x49, 2: 0x2A, 3: 0x0},
			{0: 0x4D, 1: 0x4D, 2: 0x0, 3: 0x2A}
		]
	},
	{
		mime: 'image/bmp',
		ext: 'bmp',
		checks: [{0: 0x42, 1: 0x4D}]
	},
	{
		mime: 'image/vnd.ms-photo',
		ext: 'jxr',
		checks: [{0: 0x49, 1: 0x49, 2: 0xBC}]
	},
	{
		mime: 'image/vnd.adobe.photoshop',
		ext: 'psd',
		checks: [{0: 0x38, 1: 0x42, 2: 0x50, 3: 0x53}]
	},
	{
		mime: 'application/epub+zip', //needs to be before `zip` check
		ext: 'epub',
		checks: [
			{0: 0x50, 1: 0x4B, 2: 0x3, 3: 0x4, 30: 0x6D, 31: 0x69, 32: 0x6D, 33: 0x65, 34: 0x74, 35: 0x79, 36: 0x70, 37: 0x65, 38: 0x61, 39: 0x70, 40: 0x70, 41: 0x6C, 42: 0x69, 43: 0x63, 44: 0x61, 45: 0x74, 46: 0x69, 47: 0x6F, 48: 0x6E, 49: 0x2F, 50: 0x65, 51: 0x70, 52: 0x75, 53: 0x62, 54: 0x2B, 55: 0x7A, 56: 0x69, 57: 0x70},
		]
	},
	{
		mime: 'application/x-xpinstall',
		ext: 'xpi',
		checks: [
			{0: 0x50, 1: 0x4B, 2: 0x3, 3: 0x4, 30: 'MMETA-INF/mozilla.rsa'}
		]
	},
	{
		mime: 'application/vnd.oasis.opendocument.text',
		ext: 'odt',
		checks: [
			{0: 0x50, 1: 0x4B, 2: 0x3, 3: 0x4, 30: 'mimetypeapplication/vnd.oasis.opendocument.text'}
		]
	},
	{
		mime: 'application/vnd.oasis.opendocument.spreadsheet',
		ext: 'ods',
		checks: [
			{0: 0x50, 1: 0x4B, 2: 0x3, 3: 0x4, 30: 'mimetypeapplication/vnd.oasis.opendocument.spreadsheet'}
		]
	},
	{
		mime: 'application/vnd.oasis.opendocument.presentation',
		ext: 'odp',
		checks: [
			{0: 0x50, 1: 0x4B, 2: 0x3, 3: 0x4, 30: 'mimetypeapplication/vnd.oasis.opendocument.presentation'}
		]
	},
	{
		mime: 'application/zip',
		ext: 'zip',
		checks: [
			{0: 0x50, 1: 0x4B, 2: [0x3, 0x5, 0x7], 3: [0x4, 0x6, 0x8]}
		]
	},
	{
		mime: 'application/x-tar',
		ext: 'tar',
		checks: [{257: 0x75, 258: 0x73, 259: 0x74, 260: 0x61, 261: 0x72}]
	},
	{
		mime: 'application/x-rar-compressed',
		ext: 'rar',
		checks: [
			{0: 0x52, 1: 0x61, 2: 0x72, 3: 0x21, 4: 0x1A, 5: 0x7, 6: [0x0, 0x1]}
		]
	},
	{
		mime: 'application/gzip',
		ext: 'gz',
		checks: [{0: 0x1F, 1: 0x8B, 2: 0x8}]
	},
	{
		mime: 'application/x-bzip2',
		ext: '7z',
		checks: [{0: 0x42, 1: 0x5A, 2: 0x68}]
	},
	{
		mime: 'applicaiton/x-7z-compressed',
		ext: '7z',
		checks: [{0: 0x37, 1: 0x7A, 2: 0xBC, 3: 0xAF, 4: 0x27, 5: 0x1C}]
	},
	{
		mime: 'application/x-apple-diskimage',
		ext: 'dmg',
		checks: [{0: 0x78, 1: 0x01}]
	},
	{
		mime: 'video/mp4',
		ext: 'mp4',
		checks: [
			{0: 0x33, 1: 0x67, 2: 0x70, 3: 0x35}, //3gp5
			{0: 0x0, 1: 0x0, 2: 0x0, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x6D, 9: 0x70, 10: 0x34, 11: 0x31}, //MP41
			{0: 0x0, 1: 0x0, 2: 0x0, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x6D, 9: 0x70, 10: 0x34, 11: 0x32}, //MP42
			{0: 0x0, 1: 0x0, 2: 0x0, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x69, 9: 0x73, 10: 0x6F, 11: 0x6D}, //ISOM
			{0: 0x0, 1: 0x0, 2: 0x0, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x69, 9: 0x73, 10: 0x6F, 11: 0x32}, //ISO2
			{0: 0x0, 1: 0x0, 2: 0x0, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x6D, 9: 0x6D, 10: 0x70, 11: 0x34}, //MMP4
			{0: 0x0, 1: 0x0, 2: 0x0, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x4D, 9: 0x34, 10: 0x56},           //M4V
			{0: 0x0, 1: 0x0, 2: 0x0, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x64, 9: 0x61, 10: 0x73, 11: 0x68} //DASH
		]
	},
	{
		mime: 'video/x-m4v', //dunno this was removed from file-type
		ext: 'm4v',
		checks: [{0: 0x0, 1: 0x0, 2: 0x0, 3: 0x1C, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x4D, 9: 0x34, 10: 0x56}]
	},
	{
		mime: 'audio/midi',
		ext: 'mid',
		checks: [{0: 0x4D, 1: 0x54, 2: 0x68, 3: 0x64}]
	},
	{
		mime: 'video/quicktime',
		ext: 'mov',
		checks: [
			{0: 0x0, 1: 0x0, 2: 0x0, 3: 0x14, 4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x71, 9: 0x74, 10: 0x20, 11: 0x20},
			{4: 0x66, 5: 0x72, 6: 0x65, 7: 0x65},
			{4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x71, 9: 0x74, 10: 0x20, 11: 0x20},
			{4: 0x6D, 5: 0x64, 6: 0x61, 7: 0x74}, //MJPEG
			{4: 0x77, 5: 0x69, 6: 0x64, 7: 0x65}
		]
	},
	{
		mime: 'video/x-msvideo',
		ext: 'avi',
		checks: [{0: 0x52, 1: 0x49, 2: 0x46, 3: 0x46, 8: 0x41, 9: 0x56, 10: 0x49}]
	},
	{
		mime: 'video/x-ms-wmv',
		ext: 'wmv',
		checks: [{0: 0x30, 1: 0x26, 2: 0xB2, 3: 0x75, 4: 0x8E, 5: 0x66, 6: 0xCF, 7: 0x11, 8: 0xA6, 9: 0xD9}]
	},
	{
		mime: 'video/mpeg',
		ext: 'mpg',
		checks: [
			{0: 0x0, 1: 0x0, 2: 0x1, 3: 0xBA},
			{0: 0x0, 1: 0x0, 2: 0x1, 3: 0xB3}
		]
	},
	{
		mime: 'video/3gpp',
		ext: '3gp',
		checks: [{4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x33, 9: 0x67}]
	},
	{
		mime: 'audio/mpeg',
		ext: 'mp3',
		checks: [
			{0: 0x49, 1: 0x44, 2: 0x33},
			{0: 0xFF, 1: 0xfb}
		]
	},
	{
		mime: 'audio/m4a',
		ext: 'm4a',
		checks: [
			{4: 0x66, 5: 0x74, 6: 0x79, 7: 0x70, 8: 0x4D, 9: 0x34, 10: 0x41},
			{0: 0x4D, 1: 0x34, 2: 0x41, 3: 0x20}
		]
	},
	{
		mime: 'audio/opus', //needs to be before `ogg` check
		ext: 'opus',
		checks: [{28: 0x4F, 29: 0x70, 30: 0x75, 31: 0x73, 32: 0x48, 33: 0x65, 34: 0x61, 35: 0x64}]
	},
	{
		mime: 'audio/ogg',
		ext: 'ogg',
		checks: [{0: 0x4F, 1: 0x67, 2: 0x67, 3: 0x53}]
	},
	{
		mime: 'audio/x-flac',
		ext: 'flac',
		checks: [{0: 0x66, 1: 0x4C, 2: 0x61, 3: 0x43}]
	},
	{
		mime: 'audio/x-wav',
		ext: 'wav',
		checks: [{0: 0x52, 1: 0x49, 2: 0x46, 3: 0x46, 8: 0x57, 9: 0x41, 10: 0x56, 11: 0x45}]
	},
	{
		mime: 'audio/amr',
		ext: 'amr',
		checks: [{0: 0x23, 1: 0x21, 2: 0x41, 3: 0x4D, 4: 0x52, 5: 0x0A}]
	},
	{
		mime: 'application/pdf',
		ext: 'pdf',
		checks: [{0: 0x25, 1: 0x50, 2: 0x44, 3: 0x46}]
	},
	{
		mime: 'application/x-msdownload',
		ext: 'exe',
		checks: [{0: 0x4D, 1: 0x5A}]
	},
	{
		mime: 'application/x-shockwave-flash',
		ext: 'swf',
		checks: [{0: [0x43, 0x46], 1: 0x57, 2: 0x53}]
	},
	{
		mime: 'application/rtf',
		ext: 'rtf',
		checks: [{0: 0x7B, 1: 0x5C, 2: 0x72, 3: 0x74, 4: 0x66}]
	},
	{
		mime: 'application/font-woff',
		ext: 'woff',
		checks: [
			{0: 0x77, 1: 0x4F, 2: 0x46, 3: 0x46, 4: 0x00, 5: 0x01, 6: 0x00, 7: 0x00},
			{0: 0x77, 1: 0x4F, 2: 0x46, 3: 0x46, 4: 0x4F, 5: 0x54, 6: 0x54, 7: 0x4F}
		]
	},
	{
		mime: 'application/font-woff',
		ext: 'woff2',
		checks: [
			{0: 0x77, 1: 0x4F, 2: 0x46, 3: 0x32, 4: 0x00, 5: 0x01, 6: 0x00, 7: 0x00},
			{0: 0x77, 1: 0x4F, 2: 0x46, 3: 0x32, 4: 0x4F, 5: 0x54, 6: 0x54, 7: 0x4F}
		]
	},
	{
		mime: 'application/octet-stream',
		ext: 'eot',
		checks: [
			{34: 0x4C, 35: 0x50, 8: 0x00, 9: 0x00, 10: 0x01},
			{34: 0x4C, 35: 0x50, 8: 0x01, 9: 0x00, 10: 0x02},
			{34: 0x4C, 35: 0x50, 8: 0x02, 9: 0x00, 10: 0x02}
		]
	},
	{
		mime: 'application/font-sfnt',
		ext: 'ttf',
		checks: [{0: 0x00, 1: 0x01, 2: 0x00, 3: 0x00, 4: 0x00}]
	},
	{
		mime: 'application/font-sfnt',
		ext: 'otf',
		checks: [{0: 0x4F, 1: 0x54, 2: 0x54, 3: 0x4F, 4: 0x00}]
	},
	{
		mime: 'image/x-icon',
		ext: 'ico',
		checks: [{0: 0x00, 1: 0x00, 2: 0x01, 3: 0x00}]
	},
	{
		mime: 'video/x-flv',
		ext: 'flv',
		checks: [{0: 0x46, 1: 0x4C, 2: 0x56, 3: 0x01}]
	},
	{
		mime: 'application/postscript',
		ext: 'ps',
		checks: [{0: 0x25, 1: 0x21}]
	},
	{
		mime: 'application/x-xz',
		ext: 'xz',
		checks: [{0: 0xFD, 1: 0x37, 2: 0x7A, 3: 0x58, 4: 0x5A, 5: 0x00}]
	},
	{
		mime: 'application/x-sqlite3',
		ext: 'sqlite',
		checks: [{0: 0x53, 1: 0x51, 2: 0x4C, 3: 0x69}]
	},
	{
		mime: 'application/x-nintendo-nes-rom',
		ext: 'nes',
		checks: [{0: 0x4E, 1: 0x45, 2: 0x53, 3: 0x1A}]
	},
	{
		mime: 'application/x-google-chrome-extension',
		ext: 'crx',
		checks: [{0: 0x43, 1: 0x72, 2: 0x32, 3: 0x34}]
	},
	{
		mime: 'application/vnd.ms-cab-compressed',
		ext: 'cab',
		checks: [
			{0: 0x4D, 1: 0x53, 2: 0x43, 3: 0x46},
			{0: 0x49, 1: 0x53, 2: 0x63, 3: 0x28}
		]
	},
	{
		mime: 'application/x-deb', //needs to be before `ar` check
		ext: 'deb',
		checks: [
			{0: 0x21, 1: 0x3C, 2: 0x61, 3: 0x72, 4: 0x63, 5: 0x68, 6: 0x3E, 7: 0x0A, 8: 0x64, 9: 0x65, 10: 0x62, 11: 0x69, 12: 0x61, 13: 0x6E, 14: 0x2D, 15: 0x62, 16: 0x69, 17: 0x6E, 18: 0x61, 19: 0x72, 20: 0x79}
		]
	},
	{
		mime: 'application/x-unix-archive',
		ext: 'ar',
		checks: [{0: 0x21, 1: 0x3C, 2: 0x61, 3: 0x72, 4: 0x63, 5: 0x68, 6: 0x3E}]
	},
	{
		mime: 'application/x-rpm',
		ext: 'rpm',
		checks: [{0: 0xED, 1: 0xAB, 2: 0xEE, 3: 0xDB}]
	},
	{
		mime: 'application/x-compress',
		ext: 'z',
		checks: [
			{0: 0x1F, 1: 0xA0},
			{0: 0x1F, 1: 0x9D}
		]
	},
	{
		mime: 'application/x-lzip',
		mime: 'lz',
		checks: [{0: 0x4C, 1: 0x5A, 2: 0x49, 3: 0x50}]
	},
	{
		mime: 'application/x-msi',
		ext: 'msi',
		checks: [{0: 0xD0, 1: 0xCF, 2: 0x11, 3: 0xE0, 4: 0xA1, 5: 0xB1, 6: 0x1A, 7: 0xE1}]
	},
	{
		mime: 'application/mxf',
		ext: 'mxf',
		checks: [{0: 0x06, 1: 0x0E, 2: 0x2B, 3: 0x34, 4: 0x02, 5: 0x05, 6: 0x01, 7: 0x01, 8: 0x0D, 9: 0x01, 10: 0x02, 11: 0x01, 12: 0x01, 13: 0x02}]
	}
];

module.exports = mimetypes.map((mimetype) => {
	mimetype.checks.forEach((check) => {
		Object.keys(check).forEach((key) => {
			switch (typeof(check[key])) {
				case 'string': {
					Array.from(check[key]).forEach((c, i) => {
						check[key + i] = c.charCodeAt(0);
					});
				}; break;
			}
		});
	});
	return mimetype;
})